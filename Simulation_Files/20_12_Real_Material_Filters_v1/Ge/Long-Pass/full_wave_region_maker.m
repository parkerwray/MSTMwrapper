
% Note: Used NP_20_27
ropt = [
  749.2249, ...
  565.8669, ...
  736.8252, ...
  712.1183, ...
  530.1508, ...
  502.0276, ...
  530.1508, ...
  791.2003, ...
  773.4692, ...
  478.2372, ...
  669.5459, ...
  530.1508, ...
  798.5562, ...
  502.0276, ...
  783.2299, ...
  699.5273, ...
  478.2371, ...
  530.1508, ...
  468.0189, ...
  893.6108];

wopt = [
    0.0599, ...
    0.0379, ...
    0.0578, ...
    0.0395, ...
    0.0410, ...
    0.0573, ...
    0.0409, ...
    0.1054, ...
    0.0268, ...
    0.0403, ...
    0.0437, ...
    0.0409, ...
    0.1428, ...
    0.0573, ...
    0.0630, ...
    0.0414, ...
    0.0404, ...
    0.0410, ...
    0.0228, ...
    0.0000];

%%
addpath(genpath('/home/elipaul/hypnos/Codes/MSTMwrapper')); 
MSTMwrapper_directory = '/home/elipaul/hypnos/Codes/MSTMwrapper';
%addpath(genpath('/home/elipaul/hypnos/Codes/Matlab_Functions'));  
function_directory = '/home/elipaul/hypnos/Codes/Matlab_Functions';
%addpath(genpath('/home/elipaul/hypnos/Codes/randomparticles'));  
randomparticles_directory = '/home/elipaul/hypnos/Codes/randomparticles';

% Location of the fortran compiled run program for MSTM code.
%mstm_location = '/home/elipaul/hypnos/Codes/MSTMwrapper/mstm_parallel_ubuntu.out';
mstm_location_serial = '/home/elipaul/hypnos/Codes/MSTMwrapper/mstm_serial_ubuntu.exe';

%%
%addpath(genpath('/home/elipaul/hypnos'));
%%
wopt_cutoff = 10^-4;
min_particle_diff = 1; %in nm
[ropt, wopt] = aggregate_similar_particles(ropt, wopt, wopt_cutoff, min_particle_diff);

%%
single_particle_wopt = wopt ./ (ropt.^2);
single_particle_wopt = single_particle_wopt ./ sum(single_particle_wopt);
dist = @(~) randsample(ropt, 1, true, single_particle_wopt);

%%
r_sigma = 100;
type = 'film';
dimension = 2;
bounds = [7, 7, 1];

% Sweep parameters (user plural name convention):
[~, i] = max(wopt);
center_radii = ropt(i); 

fill_fraction = [0.443537];
wavelengths = 4000:100:6000;
%wavelengths = linspace(500,900,81);


r_mean = min(ropt);

giggles = 500;

cores = 20;
seed = 1231201331;
rng(seed);

loud = 0;
%%
[sphere_cords, ff] = ...
                 randomly_placed_normally_distributed_kerker_spheres(...
                 type,...
                 dimension,...
                 fill_fraction,...
                 center_radii,...
                 r_mean,...
                 r_sigma,...
                 bounds,...
                 giggles,...
                 loud,...
                 dist);

